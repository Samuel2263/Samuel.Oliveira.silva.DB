CREATE TABLE CLIENTE (
    ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    NOME VARCHAR(50),
    EMAIL VARCHAR(100) 
);

CREATE TABLE PRODUTOS (
ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
PRODUTO VARCHAR(100),
PRECO NUMBER(30,2)
);

CREATE TABLE PEDIDOS (
    ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    CLIENTE_ID VARCHAR(100)
);

INSERT INTO CLIENTE (NOME, EMAIL) VALUES ('SAMUEL', 'SAMUEL@GMAIL.COM');

INSERT INTO PRODUTOS (PRODUTO, PRECO) VALUES ('CREME', 30.90);

SELECT * FROM CLIENTE

DELETE FROM PRODUTOS WHERE PRECO = 15.95;

INSERT INTO PRODUTOS (PRODUTO, PRECO) VALUES ('ESCOVA', 15.95);

UPDATE CLIENTE
SET NOME = 'samoel'
WHERE ID = '1';

CREATE TABLE CLIENTE_STG (
    NOME VARCHAR(100),
    EMAIL VARCHAR(100)
);

INSERT INTO CLIENTE_STG (NOME, EMAIL) VALUES ('SAMUEL OLIVEIRA', 'SAMUEL@GMAIL.COM');

INSERT INTO CLIENTE_STG (NOME, EMAIL) VALUES ('CRISTIANE', 'CRISTIANE@GMAIL.COM');

MERGE INTO CLIENTE l
USING CLIENTE_STG s
  ON (l.EMAIL = s.EMAIL)
WHEN MATCHED THEN 
  UPDATE SET l.NOME = s.NOME
WHEN NOT MATCHED THEN
  INSERT (NOME, EMAIL)
  VALUES (s.NOME, s.EMAIL);

