CREATE TABLE CLIENTE (
    ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    NOME VARCHAR2(100) NOT NULL,
    EMAIL VARCHAR2(100)  
);


CREATE TABLE PRODUTOS (
    ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    NOME VARCHAR2(100) NOT NULL,
    PRECO NUMBER(30, 2) NOT NULL
);


CREATE TABLE PEDIDOS (
    ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    CLIENTES_ID NUMBER,
    FOREIGN KEY (CLIENTES_ID) REFERENCES CLIENTE(ID)
);


INSERT INTO PRODUTOS (NOME, PRECO) VALUES ('CREME', 300.50);
INSERT INTO PRODUTOS (NOME, PRECO) VALUES ('CREME', 30.50);


INSERT INTO CLIENTE (NOME, EMAIL) VALUES ('SAMUEL', 'samuel@example.com');


SELECT * FROM PRODUTOS;


DELETE FROM PRODUTOS WHERE PRECO = 30.50;


CREATE TABLE LOJA_STG (
  NOME VARCHAR2(100) NOT NULL,
  EMAIL VARCHAR2(100)  
);

MERGE INTO CLIENTE l
USING LOJA_STG s
   ON (l.EMAIL = s.EMAIL)
WHEN MATCHED THEN
   UPDATE SET l.NOME = s.NOME
WHEN NOT MATCHED THEN
   INSERT (NOME, EMAIL)
   VALUES (s.NOME, s.EMAIL);
