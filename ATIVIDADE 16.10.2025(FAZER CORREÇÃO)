CREATE TABLE VENDAS (
    id            NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    produto       VARCHAR2(100) NOT NULL,
    categoria     VARCHAR2(50)  NOT NULL,
    valor         NUMBER(10,2)  NOT NULL CHECK (valor > 0),
    data_venda    DATE          DEFAULT SYSDATE,
    vendedor      VARCHAR2(100) NOT NULL
);

INSERT INTO VENDAS (produto, categoria, valor, data_venda, vendedor) 
VALUES 
    ('Notebook Dell', 'Eletrônicos', 4500.00, DATE '2025-04-01', 'Carlos'),
    ('Mouse Gamer', 'Acessórios', 150.00, DATE '2025-04-01', 'Ana'),
    ('Teclado Mecânico', 'Acessórios', 300.00, DATE '2025-04-02', 'Carlos'),
    ('Monitor 24"', 'Eletrônicos', 1200.00, DATE '2025-04-02', 'Bruna'),
    ('Fone Bluetooth', 'Acessórios', 200.00, DATE '2025-04-03', 'Ana'),
    ('Notebook HP', 'Eletrônicos', 4000.00, DATE '2025-04-03', 'Carlos'),
    ('Webcam HD', 'Acessórios', 180.00, DATE '2025-04-04', 'Bruna'),
    ('Carregador Portátil', 'Acessórios', 120.00, DATE '2025-04-04', 'Ana'),
    ('SSD 1TB', 'Componentes', 500.00, DATE '2025-04-05', 'Carlos'),
    ('Cabo HDMI', 'Acessórios', 50.00, DATE '2025-04-05', 'Bruna');

select produto, valor from vendas;


CREATE TABLE IF NOT EXISTS CLIENTES (
    id_clientes NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    NOME VARCHAR(100) NOT NULL,
    CIDADE VARCHAR(500),
    ESTADO VARCHAR(2)

);

INSERT INTO CLIENTES (NOME, CIDADE, ESTADO) VALUES 
('CRISTAINE','SAO PAULO', 'SP'),
('SAMUEL', 'MACAPA','AP'),



ALTER TABLE VENDAS ADD ID_CLIENTES NUMBER;
ALTER TABLE VENDAS ADD CONSTRAINT fk_CLIENTES FOREIGN KEY (id_cliente) REFERENCES CLIENTES
(ID_CLIENTES);


UPDATE VENDAS
SET id_cliente = CASE vendedor
    WHEN 'CRISTIANE' THEN 1
    WHEN 'SAMUEL' THEN 2
END;



SELECT 
C.NOME AS CLIENTE
V.VALOR 
V.PRODUTOS
C.CIDADE
FROM 
VENDAS V
INNER JOIN CLIENTES C 
ON V.ID_CLIENTES = C.ID_CLIENTES;


SELECT
    c.estado,
    SUM(v.valor) AS total_vendas
FROM VENDAS v
INNER JOIN CLIENTES c
    ON v.id_cliente = c.id_cliente
GROUP BY c.estado;
